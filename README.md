# SJEMA

Библиотека, позволяющая на основе XSD схемы получить view модель в формате JSON.
На основе view модели и XML документа строится JSON data модель.
На основе view модели и JSON data модели строится XML документ.

## Структура view модели версии "1.0"

- **version** : string - версия документа. всегда "1.0"
- **targetNamespace** : string - целевое пространство имён
- **caption** : string - название
- **description** : string - описание
- **namespaces** : object - перечень пространств имён и соответствующих им префиксов
  - **[prefix]** : string - namespace. **prefix** - префикс
- **structure** : object - структура отображения
  - **[elementId]** : object - элемент. **elementId** - уникальный идентификатор элемента (в списке элементов)
    - **...** : струтура засисит от потребностей использования
- **elements** : object - элементы
  - **[id]** : object - элемент. **id** - уникальный идентификатор элемента (в списке элементов)
    - **path** : string - путь к узлу дерева XML - как правило соответствует имени тега, который описывает элемент
    - **createEmpty** : boolean - Создавать путь, даже если значение отсутствует
    - **typeId** : string - идентификатор типа - ссылка на тип (по умолчанию используется простой тип, с "base" : "string")
    - **caption** : string - название элемента отображаемое пользователю
    - **description** : string - расширенное описание поля
    - **required** : boolean - обязательность заполнения данных (по умолчанию false)
    - **repeatable** : object - описание повторяемости элемента
      - **path** : string - путь к повторяющимуся узлу дерева XML - как правило соответствует имени тега, который описывает повторяющийся элемент
      - **min** : number - минимальное количество элементов [0 - 1] (по умолчанию 0)
      - **max** : number - максимальное количество элементов [1 - 2^7] или unbounded (по умолчанию unbounded)
      - **caption** : string - заголовок повторяемого элемента с добавление текущего индекса начиная с 1 (по умолчанию название головного элемента)
      - **addCaption** : string - название кнопки для добавления повторяемого элемента (по умолчанию "Добавить")
      - **removeCaption** : string - название кнопки для удаления повторяемого элемента (по умолчанию "Удалить")
      - **readOnly** : boolean - доступность элементов для редактирования (по умолчанию false)
      - **default** : string - значение элемента по умолчанию
- **types** : object - типы
  - **[id]** : object - тип. **id** - уникальный идентификатор типа, на основе имени типа
  - **description** : string - расширенное описание поля
  - **base** : string - базовый тип
    допустимые варианты значений:
     "boolean" - логический
     "number" - числовой
     "string" - строковый
  - **content** : object - содержимое типа
    - **mode** : string - режим обработки содержимого
      допустимые варианты значений:
        "sequence" - последовательно
        "choice" - выборочно, только один
    - **elementIds** : array - список идентификаторов элементов в порядке отображения
    - **xmlOrder** : array - список идентификаторов элементов в порядке требуемом форматом XML (по умолчанию используется порядок из elementIds)
  - **restriction** : object - описание ограничений
    - **enumeration** : object - список вариантов
    - **[value]** : string - человекочитаемаый текст. **value** - значение
    - **patterns** : array - список регулярных выражений с описаниями, одно из которых должно описать допустимое значение
      - **pattern** : string - регулярное выражение, которое определяет точную последовательность символов
      - **description** : string - описание выражения
    - **whitespace** : string - обработка пробелов
      допустимые варианты значений:
        "preserve" - сохранение всех white space символов
        "collapse" - замена всех white space символов, устранение повторяющихся пробелов на единичные
        "replace" - замена всех white space символов
    - **length** : number - длина текста
    - **minLength** : number - минимальная длина текста
    - **maxLength** : number - максимальная длина текста
    - **minInclusive** : number - минимальное числовое значение включая указанное
    - **maxInclusive** : number - максимальное числовое значение включая указанное 
    - **minExclusive** : number - минимальное числовое значение исключая указанное
    - **maxExclusive** : number - максимальное числовое значение исключая указанное
    - **totalDigits** : number - точное число разрешенных цифр [1- 2^7]
    - **fractionDigits** : number - максимальное допустимое число десятичных знаков [0 - 2^7]
  - **widget** : object - виджет
    - **name** : string - имя
    - **params** : object - параметрв
      - **...** : струтура засисит от виджета
- **mappers** : object - маперы
  - **[id]** : object - мапер. **id** - название мапера.
    - **class** : string - класс мапера
      допустимые варианты значений:
        "XmlDateFormat" - форматированое значение даты и время в формате XML
        "DateFormat" - форматированое значение даты и время
    - **params** : object - перечень параметров зависит от класса
      - **[name]** : string - значение параметра. **name** - название параметра
- **validation** : object - валидация
  - **[elementId]** :  array - список ошибок. **elementId** - идентификатор корневого элемента для применения правил
    - **rule** : string - правило поиска ошибочных вариантов
    - **message** : string - сообщение

### viev

| Название            | Тип    | Обязательность | Описание                              | Значение по умолчанию | Условия                    |
| ------------------- | ------ | -------------- | ------------------------------------- | --------------------- | -------------------------- |
| **version**         | string | +              | версия документа                      |                       | всегда имеет значение "1.0 |
| **caption**         | string |                | название                              |                       |                            |
| **description**     | string |                | описание                              |                       |                            |
| **targetNamespace** | string | +              | целевое пространство имён             |                       |                            |
| **namespaces**      | object |                | перечень пространств имён и префиксов |                       |                            |
| **structure**       | object | +              | структура отображения                 |                       |                            |
| **elements**        | object |                | элементы                              |                       |                            |
| **types**           | object |                | типы                                  |                       |                            |
| **mappers**         | object |                | маперы                                |                       |                            |
| **validation**      | object |                | валидация                             |                       |                            |
